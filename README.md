# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

# Веб-приложение для покупки продуктов

Веб-приложение для покупки различных интересных продуктов. Приложение состоит из следующих основных компонентов: модели, представления и презентеры.

## Архитектура проекта

- **Основные части архитектуры**: модель данных, API-клиент и компоненты представления. Принцип MVP (Model-View-Presenter) основан на разделении приложения на три основных компонента: модель (Model), представление (View) и презентер (Presenter). Модель отвечает за данные и бизнес-логику, представление — за отображение данных пользователю, а презентер — за управление взаимодействием между моделью и представлением.

- **Назначение частей**:
  - **Модель данных**: хранение информации о товарах, корзине, заказах и пользователях, а также обеспечение структурированного доступа и управления этой информацией.
  - **API-клиент**: удобный интерфейс для взаимодействия с удаленным API, обеспечивая получение и отправку данных.
  - **Компоненты представления**: отображение данных и обеспечение пользовательского интерфейса для взаимодействия с приложением.

- **Взаимодействие частей**: через методы и события. Например, компоненты представления генерируют события, которые обрабатываются кодом презентера. Презентер, в свою очередь, взаимодействует с моделями данных через их методы и обрабатывает события, генерируемые моделями данных при изменении данных. Таким образом, презентер управляет как моделями данных, так и компонентами представления, обеспечивая взаимодействие между ними и отображение информации в компонентах представления.

- **Компоненты приложения**: классы моделей данных (Product, Basket, Order), классы API-клиента и компоненты представления (например, список товаров, корзина, форма оформления заказа).

- **Процессы в приложении**: реализованы через события, используя класс "Брокер событий" (EventEmitter). Этот класс обеспечивает механизм для обработки событийного взаимодействия в приложении, позволяя устанавливать обработчики на конкретные события, инициировать события и управлять взаимодействием между компонентами через событийную систему.

## Описание данных

### Интерфейс товаров (IProduct)

Определяет структуру объектов, представляющих товары.

- `id`: Уникальный идентификатор товара (строка).
- `description`: Описание товара (строка).
- `image`: URL изображения товара (строка).
- `title`: Название товара (строка).
- `category`: Категория товара (строка).
- `price`: Цена товара (число или null).

### Интерфейс корзины (IBasket)

- `items`: Массив товаров в корзине (массив объектов типа IProduct).
- `add(product: IProduct)`: Метод для добавления товара в корзину.
- `remove(id: string)`: Метод для удаления товара из корзины по его идентификатору.

### Интерфейс заказа (IOrder)

Определяет структуру объектов, представляющих заказ.

- `paymentMethod`: Метод оплаты заказа (строка).
- `address`: Адрес доставки (строка).
- `email`: Email адрес заказчика (строка).
- `telephone`: Номер телефона заказчика (строка).

### Интерфейс пользователя (IUser)

Определяет структуру объектов, предоставляющих данные о пользователе.

- `email`: Email адрес пользователя (строка).
- `telephone`: Номер телефона пользователя (строка).

## API-клиент

API-клиент предоставляет удобный интерфейс для взаимодействия с удаленным API.

### Методы

- `get(uri: string): Promise<object>`: Отправляет GET-запрос к указанному ресурсу.
  - Параметры: `uri` (строка) - URI ресурса.
  - Возвращаемое значение: Promise, который разрешается в объект с данными ответа.
- `post(uri: string, data: object, method: ApiPostMethods = 'POST'): Promise<object>`: Отправляет POST-запрос к указанному ресурсу.
  - Параметры: `uri` (строка) - URI ресурса.
  - `data` (объект) - данные для отправки.
  - `method` ('POST' | 'PUT' | 'DELETE') - метод запроса (по умолчанию 'POST').
  - Возвращаемое значение: Promise, который разрешается в объект с данными ответа.

### Типы данных

- `ApiListResponse<Type>`: Общий тип данных, представляющий ответ от API, который включает в себя общее количество элементов и массив элементов указанного типа.
  - `type ApiListResponse<Type> = { total: number, items: Type[] };`
- `ApiPostMethods`: Тип данных, который ограничивает методы запроса для POST-запросов, PUT-запросов и DELETE-запросов.
  - `type ApiPostMethods = 'POST' | 'PUT' | 'DELETE';`

## Классы моделей данных

### Класс "Корзина" (Basket)

#### Состав

- `items`: Массив товаров в корзине (массив объектов типа Product).

#### Методы

- `add(product: IProduct)`: Добавляет товар в корзину по его идентификатору.
- `remove(id: string)`: Удаляет товар из корзины по его идентификатору.
- `isEmpty()`: Проверяет, пуста ли корзина (возвращает true, если корзина пуста, иначе false).
- `getItems()`: Возвращает массив товаров, находящихся в корзине.
- `getTotalCost()`: Возвращает сумму стоимости всех товаров в корзине.

#### Назначение

Этот класс предназначен для хранения и управления товарами, добавленными в корзину пользователем. Он предоставляет методы для добавления и удаления товаров из корзины, а также обеспечивает доступ к текущему списку товаров в корзине.

### Класс "Заказ" (Order)

Определяет структуру объектов, представляющих заказы.

#### Состав

- `paymentMethod`: Метод оплаты заказа (строка).
- `address`: Адрес доставки (строка).
- `email`: Email адрес заказчика (строка).
- `telephone`: Номер телефона заказчика (строка).

#### Методы

- `setPaymentMethod(method: string)`: Метод для установки метода оплаты заказа.
- `setAddress(address: string)`: Метод для установки адреса доставки.
- `setEmail(email: string)`: Метод для установки email адреса заказчика.
- `setTelephone(telephone: string)`: Метод для установки номера телефона заказчика.
- `validateEmail(email: string)`: Метод для валидации email адреса.
- `validateTelephone(telephone: string)`: Метод для валидации номера телефона.
- `validateAddress(address: string)`: Метод для валидации адреса доставки.

#### Назначение

Этот класс предназначен для хранения информации о заказах в системе. Он содержит основные данные о заказе, такие как метод оплаты, адрес доставки, контактная информация заказчика, а также методы для валидации этих данных.

### Класс "Товар" (Product)

#### Состав

- `id`: Уникальный идентификатор товара (строка).
- `description`: Описание товара (строка).
- `image`: URL изображения товара (строка).
- `title`: Название товара (строка).
- `category`: Категория товара (строка).
- `price`: Цена товара (число или null).

#### Методы

- `constructor(id: string, description: string, image: string, title: string, category: string, price: number | null)`: Создает новый объект товара с заданными параметрами.
- `getId()`: Возвращает уникальный идентификатор товара.
- `getDescription()`: Возвращает описание товара.
- `getImage()`: Возвращает URL изображения товара.
- `getTitle()`: Возвращает название товара.
- `getCategory()`: Возвращает категорию товара.
- `getPrice()`: Возвращает цену товара.

#### Назначение

Этот класс представляет модель данных товара и предоставляет методы для доступа к атрибутам товара.

### Класс "Список товаров" (ProductList)

#### Описание
Компонент "Список товаров" отображает доступные товары для покупки и предоставляет пользователю возможность выбора товаров для добавления в корзину.

#### Параметры конструктора
- `containerId: string`: Идентификатор контейнера, в котором будет отображаться список товаров.

#### Поля
- `container: HTMLElement`: Элемент контейнера, в котором отображается список товаров.

#### Методы
- `render(productsHTML: string[]): void`: Метод для отображения списка товаров на странице. Принимает массив строковых представлений HTML карточек товаров `productsHTML` и размещает их в элементе `container`.
- `productSelected(productId: string): void`: Метод для обработки события выбора товара пользователем из списка. Этот метод генерирует событие `productSelected`, передавая идентификатор выбранного товара.

#### Примечание
Класс `ProductList` отвечает за отображение списка товаров в указанном контейнере и генерирует событие `productSelected` при выборе пользователем товара из списка. Однако, за обработку этого события в отдельной карточке (например, изменение её стиля или отправка данных в корзину) отвечает сама карточка, реализованная в классе `Card`.

### Класс "Карточка товара" (ProductCard)

#### Описание

Компонент "Карточка товара" отображает информацию о конкретном товаре и позволяет пользователю добавить товар в корзину.

#### Параметры конструктора

- `product: Product`: Данные о товаре для отображения.

#### Поля

- `product: Product`: Объект с данными о товаре.
- `element: HTMLElement`: Элемент карточки товара.

#### Методы

- `render(): void`: Метод для отображения карточки товара на странице.
- `onBuyButtonClick(callback: (product: Product) => void): void`: Метод для установки обработчика события нажатия на кнопку "Купить".

#### События

- `buyButtonClick(product: Product)`: Генерируется при нажатии на кнопку "Купить". Передает объект товара.

## Классы представления

### Класс "Корзина" (BasketView)

**Описание:**  
Компонент "Корзина" отображает товары, добавленные в корзину, и позволяет пользователю управлять этими товарами (добавлять, удалять, изменять количество). Также отображает общую стоимость заказа.

**Поля:**  
- `container: HTMLElement`: Контейнер для отображения корзины.
- `buyButtonHandler: () => void`: Обработчик события нажатия на кнопку покупки.

**Методы:**  
- `render(items: IProduct[], totalCost: number): void`: Метод для отображения корзины на странице. Принимает массив товаров типа `IProduct` и общую стоимость товаров.
- `setBuyButtonHandler(handler: () => void): void`: Метод для установки обработчика события нажатия на кнопку покупки.

**Назначение:**  
Этот класс отвечает за отображение корзины и взаимодействие с пользователем, но не за управление данными корзины.

**События:**  
- `itemAdded(productId: string)`: Генерируется при добавлении нового товара в корзину. Передает идентификатор добавленного товара.
- `itemRemoved(productId: string)`: Генерируется при удалении товара из корзины. Передает идентификатор удаленного товара.
- `checkoutClicked()`: Генерируется при нажатии пользователем на кнопку оформления покупки.


### Класс "Форма доставки" (DeliveryFormView)

**Описание:**  
Компонент "Форма доставки" предоставляет пользователю форму для ввода информации о доставке, такой как адрес доставки и контактные данные.

**Поля:**  
- `container: HTMLElement`: Контейнер для отображения формы доставки.
- `submitHandler: (data: DeliveryData) => void`: Обработчик события отправки формы.

**Методы:**  
- `render(): void`: Метод для отображения формы доставки на странице.
- `setSubmitHandler(handler: (data: DeliveryData) => void): void`: Метод для установки обработчика события отправки формы.

**Назначение:**  
Отвечает за отображение и сбор данных формы доставки.

### Класс "Форма оплаты" (PaymentFormView)

**Описание:**  
Компонент "Форма оплаты" предоставляет пользователю форму для ввода информации о методе оплаты, такой как номер карты и срок действия.

**Поля:**  
- `container: HTMLElement`: Контейнер для отображения формы оплаты.
- `submitHandler: (data: PaymentData) => void`: Обработчик события отправки формы.

**Методы:**  
- `render(): void`: Метод для отображения формы оплаты на странице.
- `setSubmitHandler(handler: (data: PaymentData) => void): void`: Метод для установки обработчика события отправки формы.

**Назначение:**  
Отвечает за отображение и сбор данных формы оплаты.


### Класс "Сообщение об успешном заказе" (SuccessMessageView)

**Описание:**  
Компонент "Сообщение об успешном заказе" отображает страницу с информацией об успешном завершении заказа.

**Параметры конструктора:**  
- `containerId: string`: Идентификатор контейнера, в котором будет отображаться сообщение.

**Поля:**  
- `container: HTMLElement`: Элемент контейнера, в котором отображается сообщение.
- `message: string`: Сообщение об успешном завершении заказа.

**Методы:**  
- `render(): void`: Метод для отображения страницы с сообщением об успешном заказе.

**Назначение:**  
Отвечает за отображение страницы с сообщением об успешном заказе после оформления покупки.


## Брокер событий (EventEmitter)

### Описание

Класс "Брокер событий" обеспечивает механизм для обработки событийного взаимодействия в приложении. Он позволяет устанавливать обработчики на конкретные события, инициировать события и управлять взаимодействием между компонентами через событийную систему.

### Поля

- `events: Map<string, Function[]>`: Карта, содержащая события и связанные с ними обработчики.

### Методы

- `on(event: string, listener: Function): void`: Метод для добавления обработчика события.
- `emit(event: string, ...args: any[]): void`: Метод для инициирования события и вызова всех связанных с ним обработчиков.
- `off(event: string, listener: Function): void`: Метод для удаления обработчика события.

### События

- `itemAdded(productId: string)`: Генерируется при добавлении нового товара в корзину. Передает идентификатор добавленного товара.
- `itemRemoved(productId: string)`: Генерируется при удалении товара из корзины. Передает идентификатор удаленного товара.
- `checkoutClicked()`: Генерируется при нажатии пользователем на кнопку оформления покупки.
- `formSubmitted(orderData: IOrder)`: Генерируется при отправке пользователем формы оформления заказа. Передает данные о заказе.
- `confirmOrderClicked()`: Генерируется при нажатии пользователем на кнопку подтверждения заказа.
- `editOrderClicked()`: Генерируется при нажатии пользователем на кнопку редактирования заказа.


#### Примечания

- Для удобства использования простые типы данных вынесены в алиасы: EventName (строка или RegExp), Subscriber (функция), EmitterEvent (объект события).
- Этот класс позволяет устанавливать и снимать обработчики на конкретные события, а также на все события или по шаблону события.
- Класс обеспечивает гибкую возможность инициировать события с передачей данных.
- Метод `trigger` позволяет создавать триггеры для удобного генерирования событий с определенными данными и контекстом.
- Этот класс является основным инструментом для организации взаимодействия между компонентами приложения через событийную систему. Он обеспечивает простой и гибкий способ управления событиями и их обработчиками.

## Классы представления

## Класс "Список товаров" (ProductList)

#### Описание
Компонент "Список товаров" отображает доступные товары для покупки и предоставляет пользователю возможность выбора товаров для добавления в корзину.

#### Параметры конструктора
- `containerId: string`: Идентификатор контейнера, в котором будет отображаться список товаров.

#### Поля
- `container: HTMLElement`: Элемент контейнера, в котором отображается список товаров.

#### Методы
- `render(products: IProduct[]): void`: Метод для отображения списка товаров на странице. Принимает массив объектов типа `IProduct` и отображает информацию о каждом товаре.

#### События
- `productSelected(productId: string)`: Генерируется при выборе пользователем товара из списка. Передает идентификатор выбранного товара.

## Класс "Корзина" (Basket)

#### Описание
Компонент "Корзина" отображает товары, добавленные в корзину, и позволяет пользователю управлять этими товарами (добавлять, удалять, изменять количество). Также отображает общую стоимость заказа.

#### Поля
- `items: IProduct[]`: Массив товаров, добавленных в корзину.
- `totalCost: number`: Общая стоимость товаров в корзине.

#### Методы
- `render(): void`: Метод для отображения корзины на странице.
- `addItem(product: IProduct): void`: Метод для добавления товара в корзину. Принимает объект товара типа `IProduct`.
- `removeItem(productId: string): void`: Метод для удаления товара из корзины по его идентификатору.
- `updateTotalCost(): void`: Метод для обновления общей стоимости товаров в корзине.
- `checkout(): void`: Метод для перехода к оформлению заказа.

#### События
- `itemAdded(productId: string)`: Генерируется при добавлении нового товара в корзину. Передает идентификатор добавленного товара.
- `itemRemoved(productId: string)`: Генерируется при удалении товара из корзины. Передает идентификатор удаленного товара.
- `checkoutClicked()`: Генерируется при нажатии пользователем на кнопку оформления покупки.

## Класс "Форма оформления заказа" (OrderForm)

#### Описание
Компонент "Форма оформления заказа" предоставляет пользователю форму для ввода информации о заказе, такой как адрес доставки, метод оплаты и контактные данные.

#### Поля
- `addressInput: HTMLInputElement`: Поле ввода адреса доставки.
- `paymentMethodSelect: HTMLSelectElement`: Выпадающий список для выбора метода оплаты.
- `emailInput: HTMLInputElement`: Поле ввода email адреса заказчика.
- `phoneInput: HTMLInputElement`: Поле ввода номера телефона заказчика.

#### Методы
- `render(): void`: Метод для отображения формы оформления заказа на странице.
- `getData(): IOrder`: Метод для получения данных из формы в виде объекта заказа типа `IOrder`.

#### События
- `formSubmitted(orderData: IOrder)`: Генерируется при отправке пользователем формы оформления заказа. Передает данные о заказе.

## Класс "Сообщение об успешном заказе" (SuccessMessage)

#### Описание
Компонент "Сообщение об успешном заказе" отображает страницу с информацией об успешном завершении заказа.

#### Поля
- `message: string`: Сообщение об успешном завершении заказа.

#### Методы
- `render(): void`: Метод для отображения страницы с сообщением об успешном заказе.

## Класс "BaseComponent"

### Описание
Этот класс является базовым для всех классов представления в приложении.

#### Методы
- `render()`: Метод для отображения компонента.

## Класс "Modal"

### Описание
Представляет модальные окна в приложении.

#### Поля
- `content`: Содержимое модального окна.

#### Функционал
- `open()`: Открытие модального окна.
- `close()`: Закрытие модального окна.

## Класс "Basket"

### Описание
Отображает корзину с товарами.

#### Поля
- `items`: Массив товаров в корзине.

#### Функционал
- `setItems(items: IProduct[])`: Метод для установки списка товаров в корзине. Этот метод будет использоваться для передачи данных о товарах в корзине из главного компонента приложения. Модель корзины должна обновляться данными из модели данных, а не через методы представления.
- `setBuyButtonHandler(handler: () => void)`: Метод для установки обработчика события нажатия на кнопку покупки. Предпочтительно, кнопка покупки должна активироваться и обрабатываться в модели или контроллере, а не в представлении.

## Класс "Form"

### Описание
Отображает формы для ввода информации пользователем.

#### Поля
- `fields`: Поля формы.

#### Функционал
- `submit()`: Метод для обработки отправки формы. Включает сбор введенных данных, валидацию и отправку данных на сервер.

## Класс "Success"

### Описание
Отображает страницу успеха после успешного завершения действия.

#### Поля
- `message`: Сообщение об успешном завершении.

#### Функционал
- `render()`: Переопределенный метод для отображения страницы успеха с сообщением об успешном завершении.

## Класс "Page"

### Описание
Отображает основную страницу приложения.

#### Поля
- `content`: Содержимое страницы.

## Класс "Card"

### Описание
Компонент "Card" представляет собой карточку товара или элемента интерфейса, который отображается на странице.

### Параметры конструктора
- `element: HTMLElement`: HTML-элемент, который будет представлять карточку на странице.
- `data: CardData`: Данные, необходимые для отображения на карточке товара или элемента интерфейса.

#### Поля
- `element: HTMLElement`: HTML-элемент, который представляет карточку на странице.
- `data: CardData`: Данные, используемые для отображения на карточке.

#### Методы
- `render(): void`: Метод для отображения карточки на странице. Использует данные из `data`, чтобы заполнить элемент `element`.
- `update(data: CardData): void`: Метод для обновления данных карточки и перерисовки элемента. Принимает новые данные `data`.
- `onClick(handler: () => void): void`: Метод для установки обработчика события клика на карточку. Когда пользователь кликает на карточку, вызывается указанный обработчик `handler`.

## Класс "Order"

### Описание
Отображает информацию о заказе.

#### Поля
- `orderData`: Данные о заказе для отображения.

## Класс "Contacts"

### Описание
Отображает контактную информацию.

#### Поля
- `contactInfo`: Контактная информация для отображения.



## Взаимодействие компонентов

### Класс "Товар" (Product) и Класс "Корзина" (Basket)

- Класс "Корзина" представляет собой хранилище для товаров, добавленных в корзину.
- Пользователь может добавлять товары в корзину, вызывая метод add(product: IProduct) класса "Корзина" и передавая информацию о товаре в качестве аргумента.
- Метод add принимает объект товара (типа "Товар") в качестве параметра и добавляет его в массив items корзины.
- Для удаления товаров из корзины пользователь может использовать метод remove(id: string) класса "Корзина", передавая идентификатор товара в качестве аргумента метода.

### Класс "Заказ" (Order) и Класс "Пользователь" (User)

- Класс "Заказ" содержит информацию о заказе, включая метод оплаты, адрес доставки, email и номер телефона заказчика.
- Класс "Пользователь" предоставляет информацию о пользователе, такую как email и номер телефона.
- При оформлении заказа информация о пользователе может использоваться для заполнения соответствующих полей заказа.

### API-клиент

- API-клиент предоставляет удобный интерфейс для взаимодействия с удаленным API.
- Он позволяет отправлять GET- и POST-запросы к указанным ресурсам для получения данных и отправки данных соответственно.
- Классы "Товар", "Корзина", "Заказ" и "Пользователь" могут использовать методы API-клиента для взаимодействия с удаленным API.

### Класс "Брокер событий" (EventEmitter)

- Брокер событий обеспечивает механизм для обработки событийного взаимодействия в приложении.
- Он позволяет устанавливать обработчики на конкретные события, инициировать события и управлять взаимодействием между компонентами приложения через событийную систему.
- Классы "Товар", "Корзина", "Заказ" и "Пользователь" могут использовать брокер событий для уведомления других компонентов о различных событиях, таких как добавление товара в корзину или оформление заказа.