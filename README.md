# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

# Веб-приложение для покупки продуктов

Веб-приложение для покупки различных интересных продуктов. Приложение состоит из следующих основных компонентов: модели, представления и презентеры.

## Архитектура проекта

- **Основные части архитектуры**: модель данных, API-клиент и компоненты представления. Принцип MVP (Model-View-Presenter) основан на разделении приложения на три основных компонента: модель (Model), представление (View) и презентер (Presenter). Модель отвечает за данные и бизнес-логику, представление — за отображение данных пользователю, а презентер — за управление взаимодействием между моделью и представлением.

- **Назначение частей**:
  - **Модель данных**: хранение информации о товарах, корзине, заказах и пользователях, а также обеспечение структурированного доступа и управления этой информацией.
  - **API-клиент**: удобный интерфейс для взаимодействия с удаленным API, обеспечивая получение и отправку данных.
  - **Компоненты представления**: отображение данных и обеспечение пользовательского интерфейса для взаимодействия с приложением.

- **Взаимодействие частей**: через методы и события. Например, компоненты представления генерируют события, которые обрабатываются кодом презентера. Презентер, в свою очередь, взаимодействует с моделями данных через их методы и обрабатывает события, генерируемые моделями данных при изменении данных. Таким образом, презентер управляет как моделями данных, так и компонентами представления, обеспечивая взаимодействие между ними и отображение информации в компонентах представления.

- **Компоненты приложения**: классы моделей данных (Product, Basket, Order), классы API-клиента и компоненты представления (например, список товаров, корзина, форма оформления заказа).

- **Процессы в приложении**: реализованы через события, используя класс "Брокер событий" (EventEmitter). Этот класс обеспечивает механизм для обработки событийного взаимодействия в приложении, позволяя устанавливать обработчики на конкретные события, инициировать события и управлять взаимодействием между компонентами через событийную систему.

## Описание данных

### Интерфейс товаров (IProduct)

Определяет структуру объектов, представляющих товары.

- `id`: Уникальный идентификатор товара (строка).
- `description`: Описание товара (строка).
- `image`: URL изображения товара (строка).
- `title`: Название товара (строка).
- `category`: Категория товара (строка).
- `price`: Цена товара (число или null).

### Интерфейс корзины (IBasket)

- `items`: Массив товаров в корзине (массив объектов типа IProduct).
- `add(product: IProduct)`: Метод для добавления товара в корзину.
- `remove(id: string)`: Метод для удаления товара из корзины по его идентификатору.

### Интерфейс заказа (IOrder)

Определяет структуру объектов, представляющих заказ.

- `paymentMethod`: Метод оплаты заказа (строка).
- `address`: Адрес доставки (строка).
- `email`: Email адрес заказчика (строка).
- `telephone`: Номер телефона заказчика (строка).

### Интерфейс пользователя (IUser)

Определяет структуру объектов, предоставляющие данные о пользователе

- `email`: Email адрес пользователя (строка).
- `telephone`: Номер телефона пользователя (строка).

## API-клиент

API-клиент предоставляет удобный интерфейс для взаимодействия с удаленным API.

### Методы

- `get(uri: string): Promise<object>`: Отправляет GET-запрос к указанному ресурсу.
  - Параметры: `uri` (строка) - URI ресурса.
  - Возвращаемое значение: Promise, который разрешается в объект с данными ответа.
- `post(uri: string, data: object, method: ApiPostMethods = 'POST'): Promise<object>`: Отправляет POST-запрос к указанному ресурсу.
  - Параметры: `uri` (строка) - URI ресурса.
  - `data` (объект) - данные для отправки.
  - `method` ('POST' | 'PUT' | 'DELETE') - метод запроса (по умолчанию 'POST').
  - Возвращаемое значение: Promise, который разрешается в объект с данными ответа.

### Типы данных

- `ApiListResponse<Type>`: Общий тип данных, представляющий ответ от API, который включает в себя общее количество элементов и массив элементов указанного типа.
  - `type ApiListResponse<Type> = { total: number, items: Type[] };`
- `ApiPostMethods`: Тип данных, который ограничивает методы запроса для POST-запросов, PUT-запросов и DELETE-запросов.
  - `type ApiPostMethods = 'POST' | 'PUT' | 'DELETE';`

## Классы моделей данных

### Класс "Товар" (Product)

#### Состав

- `id`: Уникальный идентификатор товара (строка).
- `description`: Описание товара (строка).
- `image`: URL изображения товара (строка).
- `title`: Название товара (строка).
- `category`: Категория товара (строка).
- `price`: Цена товара (число или null).

#### Назначение

Этот класс предназначен для хранения информации о товарах в системе. Он обеспечивает структурированное представление данных о товаре, включая его основные характеристики, такие как описание, изображение, название, категория и цена.

### Класс "Корзина" (Basket)

#### Состав

- `items`: Массив товаров в корзине (массив объектов типа Product).

#### Методы

- `add(product: IProduct)`: Добавляет товар в корзину по его идентификатору.
- `remove(id: string)`: Удаляет товар из корзины по его идентификатору.
- `isEmpty()`: Проверяет, пуста ли корзина (возвращает true, если корзина пуста, иначе false).
- `getItems()`: Возвращает массив товаров, находящихся в корзине.
- `getTotalCost()`: Возвращает сумму стоимости всех товаров в корзине.

#### Назначение

Этот класс предназначен для хранения и управления товарами, добавленными в корзину пользователем. Он предоставляет методы для добавления и удаления товаров из корзины, а также обеспечивает доступ к текущему списку товаров в корзине.

## Класс "Заказ" (Order)

Определяет структуру объектов, представляющих заказы.

#### Состав

- `paymentMethod`: Метод оплаты заказа (строка).
- `address`: Адрес доставки (строка).
- `email`: Email адрес заказчика (строка).
- `telephone`: Номер телефона заказчика (строка).

#### Методы

- `setPaymentMethod(method: string)`: Метод для установки метода оплаты заказа.
- `setAddress(address: string)`: Метод для установки адреса доставки.
- `setEmail(email: string)`: Метод для установки email адреса заказчика.
- `setTelephone(telephone: string)`: Метод для установки номера телефона заказчика.

#### Назначение

Этот класс предназначен для хранения информации о заказа в системе. Он содержит основные данные о заказе, такие как метод оплаты, адрес доставки, контактная информация заказчика.

## Как добавить товар в корзину

Для добавления товара в корзину необходимо выполнить следующие шаги:

1. Просмотреть список доступных товаров.
2. Выбрать нужный товар из списка.
3. Открыть карточку выбранного товара.
4. Нажать на кнопку "Купить" на карточке товара.

После выполнения этих шагов выбранный товар будет добавлен в корзину.


### Класс "Брокер событий" (EventEmitter)

Этот класс представляет собой реализацию брокера событий для обработки событий в приложении.

#### Публичные методы

- `on(eventName: EventName, callback: (data: T) => void): void`: Устанавливает обработчик на событие. Принимает имя события и функцию обратного вызова, которая будет выполнена при возникновении события.
- `off(eventName: EventName, callback: Subscriber): void`: Снимает обработчик с события. Принимает имя события и функцию обратного вызова, которая была установлена как обработчик.
- `emit(eventName: string, data?: T): void`: Инициирует событие с передачей данных. Принимает имя события и, опционально, данные, которые будут переданы в обработчики события.
- `onAll(callback: (event: EmitterEvent) => void): void`: Подписывается на все события. Принимает функцию обратного вызова, которая будет вызвана при возникновении любого события.
- `offAll(): void`: Снимает все обработчики событий. Очищает список обработчиков для всех событий.
- `trigger(eventName: string, context?: Partial<T>): (data: T) => void`: Создает триггер, генерирующий событие при вызове. Возвращает функцию, которая при вызове инициирует событие с указанным именем и переданным контекстом данных.

#### Примечания

- Для удобства использования простые типы данных вынесены в алиасы: EventName (строка или RegExp), Subscriber (функция), EmitterEvent (объект события).
- Этот класс позволяет устанавливать и снимать обработчики на конкретные события, а также на все события или по шаблону события.
- Класс обеспечивает гибкую возможность инициировать события с передачей данных.
- Метод `trigger` позволяет создавать триггеры для удобного генерирования событий с определенными данными и контекстом.
- Этот класс является основным инструментом для организации взаимодействия между компонентами приложения через событийную систему. Он обеспечивает простой и гибкий способ управления событиями и их обработчиками.

## Классы представления

1. **Компонент "Список товаров"**:
   - Отображает список доступных товаров, их описание, изображения и цены. Позволяет пользователю выбирать товары для добавления в корзину.

2. **Компонент "Корзина"**:
   - Отображает товары, добавленные в корзину, и позволяет пользователю управлять этими товарами (добавлять, удалять, изменять количество). Отображает общую стоимость заказа.

3. **Компонент "Форма оформления заказа"**:
   - Предоставляет пользователю форму для ввода информации о заказе, такой как адрес доставки, метод оплаты и контактные данные.

4. **Компонент "Страница заказа"**:
   - Отображает подтверждение заказа со всей введенной пользователем информацией. Позволяет пользователю подтвердить заказ или вернуться и изменить информацию.

   

### Базовый класс представления (Component)

Этот класс является базовым для всех классов представления в приложении.

#### Методы

- `render()`: Метод для отображения компонента.

#### Примечания

- Классы представления, такие как Modal, Basket, Form, Success, наследуют от этого базового класса.

## Класс Modal

#### Описание

Представляет модальные окна в приложении.

#### Поля

- `content`: Содержимое модального окна.

#### Функционал

- `open()`: Открытие модального окна.
- `close()`: Закрытие модального окна.

## Класс Basket

#### Описание

Отображает корзину с товарами.

#### Поля

- `items`: Массив товаров в корзине.

#### Функционал

- `setItems(items: IProduct[])`: Метод для установки списка товаров в корзине. Этот метод будет использоваться для передачи данных о товарае в корзине из главного компонента приложения.
- `setBuyButtonHandler(handler: () => void)`: Метод для установки обработчика события нажатия на кнопку покупки. При нажатии на кнопку, этот обработчик будет вызываться для выполнения покупки товаров в корзине.

#### Функционал кнопки покупки

При нажатии на кнопку "Купить" на карточке товара, соответствующий товар добавляется в корзину. После этого, если в корзине есть хотя бы один товар, кнопка покупки на странице корзины становится активной. При нажатии на эту кнопку, товары в корзине будут куплены, и пользователь будет перенаправлен на страницу подтверждения заказа.


## Класс Form

#### Описание

Отображает формы для ввода информации пользователем.

#### Поля

- `fields`: Поля формы.

#### Функционал

- `submit()`: Обработка отправки формы.

## Класс Success

#### Описание

Отображает страницу успеха после успешного завершения действия.

#### Поля

- `message`: Сообщение об успешном завершении.

#### Функционал

- `render()`: Переопределенный метод для отображения страницы успеха с сообщением об успешном завершении.


## Класс Page

#### Описание

Отображает основную страницу приложения.

#### Поля

- `content`: Содержимое страницы.

## Класс Card

#### Описание

Отображает карточку товара.

#### Поля

- `product`: Данные о товаре для отображения.

## Класс Order

#### Описание

Отображает информацию о заказе.

#### Поля

- `orderData`: Данные о заказе для отображения.

## Класс Contacts

#### Описание

Отображает контактную информацию.

#### Поля

- `contactInfo`: Контактная информация для отображения.


## Взаимодействие компонентов

### Класс "Товар" (Product) и Класс "Корзина" (Basket)

- Класс "Корзина" содержит массив items, в котором хранятся объекты типа "Товар".
- Пользователь может добавлять товары в корзину, используя метод `add(product: IProduct)` класса "Корзина".
- Для удаления товаров из корзины можно использовать метод `remove(id: string)` класса "Корзина".

### Класс "Заказ" (Order) и Класс "Пользователь" (User)

- Класс "Заказ" содержит информацию о заказе, включая метод оплаты, адрес доставки, email и номер телефона заказчика.
- Класс "Пользователь" предоставляет информацию о пользователе, такую как email и номер телефона.
- При оформлении заказа информация о пользователе может использоваться для заполнения соответствующих полей заказа.

### API-клиент

- API-клиент предоставляет удобный интерфейс для взаимодействия с удаленным API.
- Он позволяет отправлять GET- и POST-запросы к указанным ресурсам для получения данных и отправки данных соответственно.
- Классы "Товар", "Корзина", "Заказ" и "Пользователь" могут использовать методы API-клиента для взаимодействия с удаленным API.

### Класс "Брокер событий" (EventEmitter)

- Брокер событий обеспечивает механизм для обработки событийного взаимодействия в приложении.
- Он позволяет устанавливать обработчики на конкретные события, инициировать события и управлять взаимодействием между компонентами приложения через событийную систему.
- Классы "Товар", "Корзина", "Заказ" и "Пользователь" могут использовать брокер событий для уведомления других компонентов о различных событиях, таких как добавление товара в корзину или оформление заказа.