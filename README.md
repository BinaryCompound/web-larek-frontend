# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Архитектура приложения
Код приложения разделён на слои согласно парадигме MVP:
- Слой представления - отвечает за отображение данных на странице
- Слой данных - отвечает за храниение и изменение данных
- Перезнтер - отвечает за связь представления и данных

## Базовый код

#### Класс Api
Содержит в себе базовую логику отправки запросов. В конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов.

Поля:

- `readonly baseUrl: string` - базовый url для api
- `protected options: RequestInit`- объект с настройками для формирования запроса.
- 
Параметры в конструкторе:

- `baseUrl: string` - базовый url для api
- `options: RequestInit` - объект с настройками для формирования запроса.

Методы:

- `protected handleResponse(response: Response): Promise<object>` - обрабатывает ответа с сервера. Если ответ с сервера пришел, то возвращается его в формате json, в противном случае формирует ошибку
- `get(uri: string): Promise<object>` - выполняет GET запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер
- `post(uri: string, data: object, method: ApiPostMethods = 'POST'): Promise<object>` - принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове метода. По умолчанию выполняется POST запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове.

#### Класс EventEmitter

Брокер событий позволяет отправлять события и подписываться на события, происходящие в системе. Класс используется в презентере для обработки событий и в слоях приложения для генерации событий.

Поля:

- `_events: Map<EventName, Set<Subscriber>>` - хранит события в виде Map, где ключом является строка или регулярное выражение, а значением сет коллбэков.
- 
Методы, геттеры и сеттеры:

- `on<T extends object>(eventName: EventName, callback: (event: T) => void)` - подписка на событие
- `off(eventName: EventName, callback: Subscriber)` - отписка от события
- `emit<T extends object>(eventName: string, data?: T)` - инициализация события
- `onAll(callback: (event: EmitterEvent) => void)` - подписаться на все события (выполнить коллбек на любое событие)
- `offAll()` - для сброса событий
- `trigger<T extends object>(eventName: string, context?: Partial<T>)` - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие.


# Описание интерфейсов и типов данных

## Интерфейсы

### Интерфейс продукта: `IProductItem`
Описание продукта в каталоге.
- `id` (string): Уникальный идентификатор продукта.
- `description` (string): Описание продукта.
- `image` (string): URL изображения продукта.
- `title` (string): Название продукта.
- `category` (string): Категория продукта.
- `price` (number): Цена продукта.


### Интерфейс заказа: `IOrderData`
Описание данных заказа.
- `payment` (`PaymentMethod`): Метод оплаты для заказа. Может быть `'cash'` или `'card'`.
- `email` (`string`): Электронная почта пользователя, связанная с заказом.
- `address` (`string`): Адрес пользователя для доставки заказа.
- `phone` (`string`): Номер телефона пользователя для связи по поводу заказа.

### Интерфейс списка продуктов: `IProductItemData`
Содержит массив продуктов.
- `products` (IProductItem[]): Массив объектов `IProductItem`.

### Интерфейс корзины: `IBasketData`
Управляет состоянием корзины.
- `goods` (IProductItem[]): Массив товаров в корзине.
- `isInBasket(id: string): boolean`: Проверяет, есть ли продукт в корзине по его `id`.
- `addToBasket(card: IProductItem): void`: Добавляет продукт в корзину.
- `removeFromBasket(id: string): void`: Удаляет продукт из корзины по его `id`.
- `clearBasket(): void`: Очищает корзину.
- `getGoodsNumber(): number`: Возвращает количество товаров в корзине.
- `getTotal(): number`: Возвращает общую стоимость товаров в корзине.
- `getIdsOfGoods(): string[]`: Возвращает массив идентификаторов товаров в корзине.

### Интерфейс API приложения: `IAppApi`
Методы для взаимодействия с API.
- `getCards(): Promise<IProductItem[]>`: Получает список продуктов.
- `getCardById(id: string): Promise<IProductItem>`: Получает продукт по его `id`.
- `postOrder(order: IOrder): Promise<TOrderSuccess>`: Отправляет заказ и возвращает результат.

### Интерфейс массива продуктов: `IProductList`
Содержит информацию о продуктах в виде массива идентификаторов.
- `total` (number): Общее количество продуктов.
- `items` (string[]): Массив идентификаторов продуктов.

### Интерфейс заказа: `IOrder`
Описание заказа.
- `payment` (PaymentMethod): Метод оплаты.
- `email` (string): Электронная почта пользователя.
- `address` (string): Адрес пользователя.
- `phone` (string): Телефонный номер пользователя.
- `total` (number): Общая стоимость заказа.
- `items` (string[]): Массив идентификаторов товаров в заказе.

### Интерфейс успешного заказа: `IOrderSuccess`
Результат успешного заказа.
- `orderSuccess` (TOrderSuccess): Информация о заказе.

### Интерфейс модального окна: `IModal`
Описание модального окна.
- `content` (HTMLElement): Контент модального окна.
- `buttonClose` (HTMLButtonElement): Кнопка закрытия модального окна.
- `open(): void`: Открывает модальное окно.
- `close(): void`: Закрывает модальное окно.

### Интерфейс представления карточки: `IProduct`
Представление продукта.
- `id` (string): Уникальный идентификатор продукта.
- `title` (string): Название продукта.
- `price` (string): Цена продукта.
- `image` (string): URL изображения продукта.
- `description` (string): Описание продукта.

### Интерфейс представления корзины: `IBasket`
Представление корзины.
- `cards` (HTMLElement[]): Массив элементов корзины.
- `total` (number): Общая стоимость товаров в корзине.
- `emptyCheck` (boolean): Проверка на пустоту корзины.

### Интерфейс представления продукта в корзине: `IProductBasket`
Представление продукта в корзине.
- `index` (number): Индекс продукта в корзине.

### Интерфейс представления формы: `IForm`
Представление формы.
- `valid` (boolean): Статус валидации формы.
- `errorMessage` (string): Сообщение об ошибке.
- `clear(): void`: Очищает форму.

### Интерфейс представления формы заказа: `IFormOrder`
Представление формы заказа.
- `orderPayment` (TPlacingOrderInfo): Информация о платеже заказа.
- `resetButtons(): void`: Сбрасывает состояние кнопок формы.
- `valid` (boolean): Статус валидации формы заказа.

### Интерфейс представления контактов пользователя: `IFormUserContacts`
Представление контактной информации пользователя.
- `userInfo` (TUserInfo): Информация о пользователе.

### Интерфейс представления успешной покупки: `ISuccess`
Представление сообщения об успешной покупке.
- `message` (TOrderSuccess): Информация о заказе.

### Интерфейс представления каталога: `IPage`
Представление страницы каталога.
- `counter` (number): Счётчик продуктов.
- `catalog` (HTMLElement[]): Массив элементов каталога.

### Интерфейс каталога продуктов: `IProductCatalog`
Фильтрация продуктов по категории.
- `category` (string): Категория продуктов.

### Интерфейс предварительного просмотра карточки: `IViewCardPreview`
Предварительный просмотр карточки продукта.
- `category` (string): Категория продукта.
- `invalidPrice` (boolean): Неверная цена.
- `buttonValidation` (boolean): Валидация кнопки.

### Интерфейс предварительного просмотра продукта: `IProductPreview`
Предварительный просмотр продукта.
- `category` (string): Категория продукта.
- `invalidPrice` (boolean): Неверная цена.
- `buttonValidation` (boolean): Валидация кнопки.

## Типы данных

### Типы успеха заказа: `TOrderSuccess`
Информация о заказе.
- `items` (string[]): Массив идентификаторов товаров.
- `total` (number): Общая стоимость заказа.

### Метод оплаты: `PaymentMethod`
Методы оплаты.
- `'cash'`: Наличные.
- `'card'`: Карта.

### Информация о пользователе: `TUserInfo`
Контактная информация пользователя.
- `phone` (string): Телефонный номер.
- `email` (string): Электронная почта.

### Информация для оформления заказа: `TPlacingOrderInfo`
Информация для оформления заказа.
- `address` (string): Адрес пользователя.
- `payment` (PaymentMethod): Метод оплаты.

### Информация о корзине: `TBasket`
Состояние корзины.
- `cards` (HTMLElement[]): Массив элементов корзины.
- `total` (number): Общая стоимость товаров в корзине.
- `emptyCheck` (boolean): Проверка на пустоту корзины.

### Информация о корзине для модального окна: `TBasketInfo`
Информация о корзине для модального окна.
- `total` (number): Общая стоимость товаров.
- `items` (string[]): Массив идентификаторов товаров.

### Тип модального окна: `TModal`
Информация о модальном окне.
- `content` (HTMLElement): Контент модального окна.

### Предварительный просмотр продукта: `TProductPreview`
Предварительный просмотр продукта.
- `id` (string): Уникальный идентификатор продукта.
- `title` (string): Название продукта.
- `price` (number): Цена продукта.
- `category` (string): Категория продукта.
- `image` (string): URL изображения продукта.
- `invalidPrice` (boolean): Неверная цена.
- `buttonValidation` (boolean): Валидация кнопки.

### Продукт в корзине: `TProductBasket`
Продукт в корзине.
- `id` (string): Уникальный идентификатор продукта.
- `title` (string): Название продукта.
- `price` (number): Цена продукта.
- `index` (number): Индекс продукта в корзине.

### Классы категорий: `TCategoryClassNames`
Классы CSS для категорий продуктов.
- `'card__category_soft'`
- `'card__category_other'`
- `'card__category_additional'`
- `'card__category_button'`
- `'card__category_hard'`

### Классы категорий: `TCategoryClasses`
Запись классов категорий.
- `string` (TCategoryClassNames): Класс для категории.

### Каталог продуктов: `TProductCatalog`
Каталог продуктов.
- `id` (string): Уникальный идентификатор продукта.
- `title` (string): Название продукта.
- `price` (number): Цена продукта.
- `category` (string): Категория продукта.
- `image` (string): URL изображения продукта.

### Форма: `TForm`
Форма.
- `valid` (boolean): Статус валидации формы.
- `errorMessage` (string): Сообщение об ошибке.

### Форма контактов: `TFormContacts`
Контактная информация в форме.
- `email` (string): Электронная почта.
- `phone` (string): Телефонный номер.
- `valid` (boolean): Статус валидации формы.

### Оплата: `TPayment`
Информация о платеже.
- `payment` (PaymentMethod): Метод оплаты.

### Форма заказа: `TFormOrder`
Форма заказа.
- `payment` (TPayment): Информация о платеже.
- `address` (string): Адрес пользователя.
- `valid` (boolean): Статус валидации формы.

### Идентификатор: `TId`
Идентификатор.
- `id` (string): Уникальный идентификатор.

# Слой данных Model

## Описание

Файл `basketData.ts` содержит реализацию класса `ShoppingCart`, который управляет состоянием корзины покупок. Этот класс реализует интерфейс `IBasketData` и использует события для оповещения о изменениях в корзине.

# Класс `ShoppingCart`

## Описание

Класс `ShoppingCart` представляет корзину покупок в приложении. Он управляет товарами, находящимися в корзине, вычисляет общую стоимость динамически и предоставляет методы для добавления, удаления и очистки товаров в корзине. Также он отвечает за оповещение других частей приложения об изменениях в корзине.

## Свойства

- **`_goods`**: Массив товаров (`IProductItem[]`), находящихся в корзине. Доступ к этому свойству осуществляется через геттер и сеттер.
- **`events`**: Экземпляр класса `IEvents`, используемый для управления событиями.

## Конструктор

### `constructor(events: IEvents)`

Создаёт экземпляр корзины с заданным объектом `events`.

**Параметры:**

- `events`: Экземпляр класса `IEvents`, используемый для управления событиями.

## Методы

### `get goods(): IProductItem[]`

Геттер для доступа к массиву товаров в корзине.

**Возвращает:**

- Текущий массив товаров.

### `set goods(cards: IProductItem[])`

Сеттер для установки массива товаров в корзине.

**Параметры:**

- `cards`: Массив товаров (`IProductItem[]`).

При изменении товаров вызывается метод `checkEmpty()`, который проверяет, пуста ли корзина.

### `isInBasket(id: string): boolean`

Проверяет наличие товара в корзине по его идентификатору `id`.

**Параметры:**

- `id`: Идентификатор товара.

**Возвращает:**

- `true`, если товар есть в корзине, иначе `false`.

### `checkBasket(id: string): void`

Проверяет, есть ли товар в корзине по идентификатору `id`.

**Параметры:**

- `id`: Идентификатор товара.

Если товар присутствует, вызывается событие `addToBasket:disabled`.

### `addToBasket(card: IProductItem): void`

Добавляет товар в корзину.

**Параметры:**

- `card`: Объект товара (`IProductItem`).

После добавления товара вызывается метод `checkEmpty()` для проверки, пуста ли корзина, и событие `basketData:changed` с информацией о добавленном товаре.

### `removeFromBasket(id: string): void`

Удаляет товар из корзины по идентификатору `id`.

**Параметры:**

- `id`: Идентификатор товара.

После удаления товара вызывается метод `checkEmpty()` для проверки, пуста ли корзина, и событие `basketData:changed` с информацией о удалённом товаре.

### `clearBasket(): void`

Очищает корзину, устанавливая массив товаров в пустой.

После очистки корзины вызывается метод `checkEmpty()` для проверки, пуста ли корзина, и событие `basketData:changed` с пустым массивом товаров.

### `getGoodsNumber(): number`

Возвращает общее количество товаров в корзине.

**Возвращает:**

- Общее количество товаров (`number`).

### `getTotal(): number`

Возвращает общую стоимость всех товаров в корзине.

**Возвращает:**

- Общую стоимость (`number`), вычисленную динамически на основе текущих товаров в корзине.

### `getIdsOfGoods(): string[]`

Возвращает массив идентификаторов товаров, находящихся в корзине.

**Возвращает:**

- Массив идентификаторов товаров (`string[]`).

### `checkEmpty(): void`

Приватный метод, проверяющий, пуста ли корзина.

Если корзина пуста, вызывается событие `basket:empty`. Если в корзине есть товары, вызывается событие `basket:has-items`.

## Зависимости

- **`IBasketData`**: Интерфейс, который реализует класс `ShoppingCart`.
- **`IProductItem`**: Интерфейс, описывающий свойства продукта.
- **`IEvents`**: Интерфейс для работы с событиями, используется для оповещения об изменениях в корзине.

# Файл `orderData.ts`

## Описание

Файл `orderData.ts` содержит реализацию класса `Order`, который управляет данными заказа. Этот класс реализует интерфейс `IOrder` и использует события для оповещения о изменениях.

# Класс `Order`

## Описание

Класс `Order` представляет заказ в приложении. Он управляет данными о заказе, такими как метод оплаты, контактная информация пользователя и данные корзины. Класс также предоставляет геттеры и сеттеры для этих данных.

## Свойства

- **`_payment`**: Приватное свойство, хранящее метод оплаты (`PaymentMethod`) для заказа.
- **`_email`**: Приватное свойство, хранящее электронную почту пользователя (`string`).
- **`_address`**: Приватное свойство, хранящее адрес пользователя (`string`).
- **`_phone`**: Приватное свойство, хранящее номер телефона пользователя (`string`).
- **`events`**: Экземпляр класса `IEvents`, используемый для управления событиями.
- **`total`**: Публичное свойство, которое хранит общую сумму заказа. В текущей реализации, это свойство не рассчитывается и требует добавления соответствующей логики.
- **`items`**: Публичное свойство, которое хранит массив идентификаторов товаров. В текущей реализации, это свойство не заполняется и требует добавления соответствующей логики.

## Конструктор

### `constructor(events: IEvents)`

Создаёт экземпляр класса `Order` с заданным объектом `events`.

**Параметры:**

- **`events`**: Экземпляр класса `IEvents`, используемый для управления событиями.

## Методы

### `set payment(type: PaymentMethod)`

Устанавливает метод оплаты для заказа.

**Параметры:**

- **`type`**: Метод оплаты (`PaymentMethod`), который может быть `'cash'` или `'card'`.

### `get payment(): PaymentMethod`

Возвращает текущий метод оплаты.

**Возвращает:**

- Метод оплаты (`PaymentMethod`).

### `set email(value: string)`

Устанавливает электронную почту пользователя.

**Параметры:**

- **`value`**: Электронная почта пользователя (`string`).

### `get email(): string`

Возвращает текущую электронную почту пользователя.

**Возвращает:**

- Электронную почту пользователя (`string`).

### `set address(value: string)`

Устанавливает адрес пользователя.

**Параметры:**

- **`value`**: Адрес пользователя (`string`).

### `get address(): string`

Возвращает текущий адрес пользователя.

**Возвращает:**

- Адрес пользователя (`string`).

### `set phone(value: string)`

Устанавливает номер телефона пользователя.

**Параметры:**

- **`value`**: Номер телефона пользователя (`string`).

### `get phone(): string`

Возвращает текущий номер телефона пользователя.

**Возвращает:**

- Номер телефона пользователя (`string`).

## Зависимости

- **`IOrder`**: Интерфейс, который реализует класс `Order`.
- **`PaymentMethod`**: Тип, определяющий методы оплаты (`'cash' | 'card'`).
- **`IEvents`**: Интерфейс для работы с событиями, используется для оповещения о изменениях.

# Файл `productData.ts`

## Описание

Файл `productData.ts` содержит реализацию класса `ProductItem`, который управляет данными продуктов. Этот класс реализует интерфейс `IProductItemData` и использует события для оповещения об изменениях в продуктах.

## Класс `ProductItem`

### Свойства
- **`_products`**: Приватный массив для хранения данных о продуктах (`IProductItem[]`).
- **`events`**: Экземпляр класса `IEvents`, используемый для управления событиями.

### Конструктор
- **`constructor(events: IEvents)`**: Создаёт экземпляр класса `ProductItem` с заданным объектом `events`.

### Методы

- **`set products(products: IProductItem[])`**: Сеттер для установки массива продуктов. Обновляет как `_products`, так и `cards`, и вызывает событие `cards:changed` для оповещения об изменении продуктов.

- **`get products()`**: Геттер для получения массива продуктов.

- **`getCard(id: string)`**: Возвращает карточку продукта по его идентификатору `id` из массива `cards`.

- **`getProductById(id: string)`**: Возвращает продукт по его идентификатору `id` из массива `_products`.

## Зависимости

- **`IProductItem`**: Интерфейс, описывающий свойства продукта.
- **`IProductItemData`**: Интерфейс, содержащий массив продуктов (`IProductItem[]`).
- **`IEvents`**: Интерфейс для работы с событиями, используется для оповещения о изменениях продуктов.

# Файл `successData.ts`

## Описание

Файл `successData.ts` содержит реализацию класса `Success`, который управляет данными об успешном заказе. Этот класс реализует интерфейс `IOrderSuccess` и использует события для оповещения об изменениях.

# Слой данных View
# Файл `basket.ts`

## Описание

Файл `basket.ts` содержит реализацию класса `Basket`, который отвечает за представление и управление корзиной покупок в пользовательском интерфейсе. Этот класс наследуется от `View` и реализует интерфейс `IBasket`.

## Класс `Basket`

### Свойства

- **`_cardList`**: DOM элемент, представляющий список товаров, добавленных в корзину (`HTMLUListElement`).

- **`totalCost`**: DOM элемент, отображающий общую стоимость товаров в корзине (`HTMLSpanElement`).

- **`basketToOrder`**: DOM элемент кнопки "Оформить заказ" (`HTMLButtonElement`).

### Конструктор

- **`constructor(container: HTMLElement, events: IEvents)`**: Создаёт экземпляр класса `Basket`, инициализируя DOM элементы и добавляя обработчик события для кнопки "Оформить заказ".

### Методы

- **`set cards(items: HTMLElement[])`**: Устанавливает список товаров в корзине, заменяя содержимое элемента `_cardList`.

- **`set total(value: number)`**: Обновляет отображаемую общую стоимость товаров в корзине, устанавливая текст элемента `totalCost`.

- **`set emptyCheck(state: boolean)`**: Устанавливает состояние кнопки "Оформить заказ". Если корзина пуста (`state` равно `true`), кнопка отключается.

## Зависимости

- **`TBasket`**: Тип данных для корзины.
- **`IBasket`**: Интерфейс, который реализует класс `Basket`.
- **`IEvents`**: Интерфейс для работы с событиями.
- **`View`**: Базовый класс для представления данных на странице.
- **`ensureElement`**: Утилитная функция для безопасного получения DOM элементов.

# Файл `form.ts`

## Описание

Файл `form.ts` содержит абстрактный класс `Form`, который управляет формами в пользовательском интерфейсе. Этот класс наследуется от `View` и реализует интерфейс `IForm`. Класс предназначен для работы с формами, валидацией и обработкой событий.

## Класс `Form<T>`

### Свойства

- **`container`**: DOM элемент формы (`HTMLFormElement`). Основной контейнер для формы.
- **`inputs`**: Массив всех полей ввода формы (`HTMLInputElement[]`). Содержит все элементы ввода в форме.
- **`submitButton`**: Кнопка отправки формы (`HTMLButtonElement`). Кнопка, которая отправляет данные формы.
- **`errorSpan`**: Спан для отображения сообщений об ошибках (`HTMLSpanElement`). Элемент, в котором отображаются сообщения об ошибках.

### Конструктор

#### `constructor(container: HTMLElement, events: IEvents)`

Создаёт экземпляр класса `Form`, инициализируя DOM элементы формы и добавляя обработчики событий для кнопки сабмита и полей ввода.

**Параметры:**

- `container`: DOM элемент, содержащий форму (`HTMLElement`).
- `events`: Экземпляр класса `IEvents`, используемый для управления событиями.

### Методы

#### `set valid(state: boolean): void`

Устанавливает активное/блокированное состояние кнопки сабмита в зависимости от значения `state`. Если форма валидна (`state` равно `true`), кнопка становится активной; в противном случае — блокируется.

**Параметры:**

- `state`: Логическое значение, указывающее, является ли форма валидной (`boolean`).

#### `get valid(): boolean`

Проверяет валидность формы. Возвращает `true`, если все поля ввода содержат данные, и `false` в противном случае.

**Возвращает:**

- Логическое значение (`boolean`), указывающее, является ли форма валидной.

#### `set errorMessage(value: string): void`

Устанавливает сообщение об ошибке, отображаемое в `errorSpan`.

**Параметры:**

- `value`: Сообщение об ошибке (`string`).

#### `clear(): void`

Очищает форму, сбрасывая её содержимое.

**Возвращает:**

- `void`.

#### `render(data: Partial<T> & TForm): HTMLElement`

Рендерит форму с предоставленными данными. Обновляет форму и возвращает DOM элемент контейнера.

**Параметры:**

- `data`: Данные для рендеринга формы. Тип `Partial<T> & TForm`.

**Возвращает:**

- DOM элемент контейнера (`HTMLElement`).

#### `private updateValidity(): void`

Обновляет состояние валидности формы и сообщение об ошибке. Этот метод проверяет, являются ли все поля ввода заполненными. Если форма валидна, сообщение об ошибке очищается. В противном случае, уста


# Класс `FormContacts`

## Свойства

- **`emailInput`**: Поле ввода электронной почты (`HTMLInputElement`).
- **`telephoneInput`**: Поле ввода телефонного номера (`HTMLInputElement`).

## Конструктор

- **`constructor(container: HTMLElement, events: IEvents)`**: Создаёт экземпляр класса `FormContacts`, инициализирует поля ввода и добавляет обработчики событий для каждого из них. При вводе данных в поля генерируются события `email:input`, `telephone:input` и `contacts:input`.

## Методы

- **`get email()`**: Возвращает значение поля электронной почты.
- **`get phone()`**: Возвращает значение поля телефонного номера.
- **`get valid()`**: Проверяет валидность формы. Возвращает `true`, если оба поля (электронная почта и телефон) заполнены. Иначе возвращает `false` и устанавливает соответствующее сообщение об ошибке.
- **`set valid(value: boolean)`**: Устанавливает состояние валидности формы через метод родительского класса `Form`.
- **`private getFormData()`**: Возвращает данные формы, включая значения полей `email`, `phone` и состояние `valid`.

## Зависимости

- **`IFormUserContacts`**: Интерфейс для данных формы контактов пользователя.
- **`TFormContacts`**: Тип данных для формы контактов, включает свойства для `email`, `phone` и `valid`.
- **`Form`**: Абстрактный базовый класс для работы с формами.
- **`ensureElement`**: Утилитная функция для безопасного получения одного DOM элемента.
- **`IEvents`**: Интерфейс для работы с событиями.


# Файл `modal.ts`

## Описание

Файл `modal.ts` содержит реализацию класса `Modal`, который управляет отображением и функциональностью модальных окон в пользовательском интерфейсе. Этот класс расширяет базовый класс `View` и реализует интерфейс `IModal`.

## Класс `Modal`

### Свойства

- **`_content`**: Приватное свойство, которое хранит содержимое модального окна (`HTMLElement`).

- **`buttonClose`**: Кнопка для закрытия модального окна (`HTMLButtonElement`).

### Конструктор

- **`constructor(container: HTMLElement, events: IEvents)`**: Создаёт экземпляр класса `Modal`, инициализируя элементы модального окна и добавляя обработчики событий. 
  - Добавляет обработчик события `mouseup` на контейнер модального окна, чтобы закрыть модальное окно при клике вне его содержимого.
  - Инициализирует элементы `_content` и `buttonClose`, а также добавляет обработчик кликов на кнопку закрытия, чтобы закрыть модальное окно.

### Методы

- **`open()`**: Открывает модальное окно. Добавляет класс `modal_active` к контейнеру модального окна и эмитит событие `modal:open`.

- **`close()`**: Закрывает модальное окно. Удаляет класс `modal_active` с контейнера модального окна и эмитит событие `modal:close`.

- **`set content(value: HTMLElement)`**: Устанавливает содержимое модального окна, заменяя текущих дочерние элементы `_content` на переданный элемент.

## Зависимости

- **`IModal`**: Интерфейс, который реализует класс `Modal`.
- **`TModal`**: Тип данных для модального окна, включает свойства для контента и кнопки закрытия.
- **`View`**: Базовый класс для представления данных на странице.
- **`ensureElement`**: Утилитная функция для безопасного получения одного DOM элемента.
- **`IEvents`**: Интерфейс для работы с событиями.

# Файл `orderForm.ts`

## Описание

Файл `orderForm.ts` содержит реализацию класса `FormOrder`, который управляет формой для оформления заказа. Этот класс расширяет абстрактный класс `Form` и реализует интерфейс `IFormOrder`. Класс позволяет пользователю выбирать метод оплаты (онлайн или при получении) и вводить адрес доставки.

## Класс `FormOrder`

### Свойства

- **`buttonsContainer`**: Контейнер для кнопок выбора метода оплаты (`HTMLDivElement`).

- **`buttonOnline`**: Кнопка для выбора онлайн-оплаты (`HTMLButtonElement`).

- **`buttonOnDelivery`**: Кнопка для выбора оплаты при получении (`HTMLButtonElement`).

- **`addressInput`**: Поле ввода адреса доставки (`HTMLInputElement`).

### Конструктор

- **`constructor(container: HTMLFormElement, events: IEvents)`**: Создаёт экземпляр класса `FormOrder`, инициализируя элементы формы и добавляя обработчики событий:
  - Инициализирует кнопки выбора метода оплаты и поле ввода адреса.
  - Добавляет обработчики кликов на кнопки для выбора метода оплаты и изменение состояния активности кнопок.
  - Добавляет обработчик события ввода в поле адреса для обновления состояния формы.

### Методы

- **`getButtonActive()`**: Возвращает активную кнопку выбора метода оплаты (`HTMLButtonElement`). Если активна кнопка онлайн-оплаты, возвращает её, иначе возвращает кнопку оплаты при получении.

- **`resetButtons()`**: Сбрасывает активный статус кнопок, убирая класс активности с обеих кнопок.

- **`set payment(value: PaymentMethod | null)`**: Устанавливает метод оплаты, меняя активность кнопок в зависимости от значения. Устанавливает активную кнопку и обновляет значение метода оплаты.

- **`get payment()`**: Возвращает метод оплаты в виде строки (`PaymentMethod`), соответствующий активной кнопке. Если ни одна кнопка не активна, возвращает `null`.

- **`get address()`**: Возвращает значение поля ввода адреса.

- **`get valid()`**: Проверяет валидность формы. Возвращает `true`, если поле адреса заполнено и выбран метод оплаты. Устанавливает соответствующее сообщение об ошибке, если данные невалидны.

- **`set valid(value: boolean)`**: Устанавливает состояние валидности формы через метод родительского класса `Form`.

- **`clear()`**: Очищает форму и сбрасывает состояние кнопок.

## Зависимости

- **`IFormOrder`**: Интерфейс для данных формы заказа, включая метод оплаты и адрес доставки.
- **`PaymentMethod`**: Тип данных для метода оплаты (онлайн или при получении).
- **`TFormOrder`**: Тип данных для формы заказа, включает свойства для метода оплаты и адреса.
- **`TPlacingOrderInfo`**: Тип данных для информации о заказе.
- **`Form`**: Абстрактный базовый класс для работы с формами.
- **`ensureElement`**: Утилитная функция для безопасного получения одного DOM элемента.
- **`IEvents`**: Интерфейс для работы с событиями.

# Файл `page.ts`

## Описание

Файл `page.ts` содержит реализацию класса `Page`, который управляет отображением страницы каталога товаров. Этот класс расширяет базовый класс `View` и реализует интерфейс `IPage`. Класс предоставляет методы для управления содержимым каталога, отображением счетчика товаров в корзине и блокировкой экрана.

## Класс `Page`

### Свойства

- **`_gallery`**: DOM элемент, содержащий галерею товаров (`HTMLElement`).

- **`buttonBasket`**: Кнопка для открытия корзины (`HTMLButtonElement`).

- **`_counter`**: DOM элемент для отображения счетчика товаров в корзине (`HTMLSpanElement`).

- **`screen`**: Основной контейнер страницы для управления блокировкой экрана (`HTMLDivElement`).

### Конструктор

- **`constructor(container: HTMLElement, events: IEvents)`**: Создаёт экземпляр класса `Page`, инициализируя элементы страницы и добавляя обработчики событий:
  - Инициализирует кнопку для открытия корзины и добавляет обработчик клика для эмита события `viewBasket:open`.
  - Инициализирует счетчик товаров в корзине.
  - Инициализирует контейнер галереи и основной контейнер страницы.

### Методы

- **`set catalog(viewCards: HTMLElement[])`**: Устанавливает содержимое каталога товаров, заменяя текущие элементы на переданные `viewCards`. Используется для отображения карточек товаров в галерее.

- **`set counter(value: number)`**: Устанавливает значение счетчика товаров в корзине. Обновляет текстовое содержимое элемента `_counter` на переданное значение.

- **`lockScreen(value: boolean)`**: Управляет блокировкой экрана страницы. Если `value` равно `true`, добавляет класс `page__wrapper_locked` к элементу `screen`, блокируя экран. Если `value` равно `false`, удаляет класс, разблокируя экран. Логи выводятся в консоль для отслеживания состояния экрана.

## Зависимости

- **`IPage`**: Интерфейс для представления страницы, включающий методы и свойства для управления отображением.
- **`ensureElement`**: Утилитная функция для безопасного получения одного DOM элемента.
- **`IEvents`**: Интерфейс для работы с событиями.
- **`View`**: Базовый класс для представления, обеспечивающий основные методы и свойства для работы с DOM элементами.

# Файл `product.ts`

## Описание

Файл `product.ts` содержит реализацию абстрактного класса `Product`, который управляет отображением карточки товара на странице. Этот класс расширяет базовый класс `View` и реализует интерфейс `IProduct`. Он предоставляет методы и свойства для работы с различными аспектами карточки товара, такими как идентификатор, заголовок, цена, изображение, описание и категория.

## Класс `Product<T>`

### Свойства

- **`_id`**: Идентификатор товара (`string`). Уникальный идентификатор для каждого товара.
- **`_title`**: DOM элемент, содержащий заголовок товара (`HTMLHeadingElement`). Элемент, в котором отображается заголовок товара.
- **`_price`**: DOM элемент, содержащий цену товара (`HTMLSpanElement`). Элемент, в котором отображается цена товара.

### Конструктор

#### `constructor(container: HTMLElement, events: IEvents)`

Создаёт экземпляр класса `Product`, инициализируя элементы страницы для отображения карточки товара и устанавливая обработчики событий. Ищет и сохраняет DOM элементы для заголовка и цены товара.

**Параметры:**

- `container`: DOM элемент, содержащий карточку товара (`HTMLElement`).
- `events`: Экземпляр класса `IEvents`, используемый для управления событиями.

### Методы и свойства

#### `set id(value: string): void`

Устанавливает идентификатор товара.

**Параметры:**

- `value`: Идентификатор товара (`string`).

#### `get id(): string`

Возвращает идентификатор товара.

**Возвращает:**

- Идентификатор товара (`string`).

#### `set title(value: string): void`

Устанавливает заголовок товара в соответствующий DOM элемент.

**Параметры:**

- `value`: Заголовок товара (`string`).

#### `get title(): string`

Возвращает текст заголовка товара.

**Возвращает:**

- Заголовок товара (`string`).

#### `set price(value: string): void`

Устанавливает цену товара в соответствующий DOM элемент. Форматирует цену с добавлением текста синапсов или устанавливает текст "Бесценно", если цена не указана.

**Параметры:**

- `value`: Цена товара (`string`).

#### `get price(): string`

Возвращает текст цены товара.

**Возвращает:**

- Цена товара (`string`).

#### `set image(src: string): void`

Абстрактный метод для установки изображения товара. Реализация этого метода должна быть предоставлена в конкретных наследниках класса `Product`.

**Параметры:**

- `src`: URL изображения товара (`string`).

#### `get image(): string`

Абстрактный метод для получения ссылки на изображение товара. Реализация этого метода должна быть предоставлена в конкретных наследниках класса `Product`.

**Возвращает:**

- URL изображения товара (`string`).

#### `set description(value: string): void`

Абстрактный метод для установки описания товара. Реализация этого метода должна быть предоставлена в конкретных наследниках класса `Product`.

**Параметры:**

- `value`: Описание товара (`string`).

#### `addClassToCategory(value: string): void`

Абстрактный метод для добавления класса к элементу категории товара. Реализация этого метода должна быть предоставлена в конкретных наследниках класса `Product`.

**Параметры:**

- `value`: Класс для добавления (`string`).

## Класс `ImageProduct`

### Свойства

- **`_image`**: DOM элемент для изображения товара (`HTMLImageElement | null`). Элемент, в котором отображается изображение товара.
- **`_description`**: DOM элемент для описания товара (`HTMLParagraphElement | null`). Элемент, в котором отображается описание товара.
- **`_category`**: DOM элемент для категории товара (`HTMLSpanElement | null`). Элемент, в котором отображается категория товара.

### Конструктор

#### `constructor(container: HTMLElement, events: IEvents)`

Создаёт экземпляр класса `ImageProduct`, инициализируя элементы страницы для отображения изображения, описания и категории товара. Ищет и сохраняет DOM элементы для изображения, описания и категории товара.

**Параметры:**

- `container`: DOM элемент, содержащий карточку товара (`HTMLElement`).
- `events`: Экземпляр класса `IEvents`, используемый для управления событиями.

### Методы и свойства

#### `get image(): string`

Возвращает ссылку на изображение товара. Если элемент изображения существует, возвращает его `src`.

**Возвращает:**

- URL изображения товара (`string`).

#### `set image(src: string): void`

Устанавливает изображение товара, если элемент изображения существует. Вызывает метод `setImage` для установки источника изображения.

**Параметры:**

- `src`: URL изображения товара (`string`).

#### `get description(): string`

Возвращает текст описания товара. Если элемент описания существует, возвращает его текстовое содержимое.

**Возвращает:**

- Описание товара (`string`).

#### `set description(value: string): void`

Устанавливает текст описания товара в соответствующий DOM элемент, если элемент описания существует.

**Параметры:**

- `value`: Описание товара (`string`).

#### `addClassToCategory(value: string): void`

Добавляет класс к элементу категории товара в зависимости от её значения. Удаляет старые классы категории и добавляет новый класс, основываясь на содержимом `value` и константах из `categories`.

**Параметры:**

- `value`: Класс для добавления (`string`).

### Зависимости

- **`IProduct`**: Интерфейс для представления товара, включая его свойства и методы.
- **`ensureElement`**: Утилитная функция для безопасного получения одного DOM элемента.
- **`categories`**: Константы, определяющие классы для категорий товаров.
- **`View`**: Базовый класс для представления, обеспечивающий основные методы и свойства для работы с DOM элементами.

# Файл `productCatalog.ts`

## Описание

Файл `productCatalog.ts` содержит реализацию класса `ProductItemCatalogue`, который представляет карточку товара в каталоге продуктов. Этот класс расширяет абстрактный класс `Product` и реализует интерфейс `IProductCatalog`. Он управляет отображением изображения, категории и описания товара, а также добавляет функциональность для обработки событий на карточке товара.

## Класс `ProductItemCatalogue<TProductCatalog>`

### Свойства

- **`_image`**: DOM элемент для изображения товара (`HTMLImageElement`). Элемент, в котором отображается изображение товара.
- **`_category`**: DOM элемент для категории товара (`HTMLSpanElement`). Элемент, в котором отображается категория товара.
- **`_description`**: DOM элемент для описания товара (`HTMLParagraphElement | null`). Элемент, в котором отображается описание товара. Может быть `null`, если элемент не существует.

### Конструктор

#### `constructor(container: HTMLElement, events: IEvents)`

Создаёт экземпляр класса `ProductItemCatalogue`, инициализируя элементы страницы для отображения карточки товара. Ищет и сохраняет DOM элементы для изображения, категории и описания товара. Также добавляет обработчик клика на карточку товара, который вызывает событие `modal-card:open` с идентификатором товара.

**Параметры:**

- `container`: DOM элемент, содержащий карточку товара (`HTMLElement`).
- `events`: Экземпляр класса `IEvents`, используемый для управления событиями.

### Методы и свойства

#### `protected addCSSClassCategory(value: string): void`

Добавляет CSS класс к элементу категории товара в зависимости от значения `value`. Использует константы из `categories` для определения нужного класса.

**Параметры:**

- `value`: Класс для добавления (`string`).

#### `get image(): string`

Возвращает ссылку на изображение товара. Возвращает `src` элемента изображения.

**Возвращает:**

- URL изображения товара (`string`).

#### `set image(src: string): void`

Устанавливает изображение товара. Устанавливает атрибут `src` для элемента изображения и обновляет атрибут `alt`, чтобы отразить заголовок товара.

**Параметры:**

- `src`: URL изображения товара (`string`).

#### `get category(): string`

Возвращает текст категории товара. Возвращает текстовое содержимое элемента категории.

**Возвращает:**

- Категория товара (`string`).

#### `set category(value: string): void`

Устанавливает текст категории товара в соответствующий DOM элемент. Также добавляет CSS класс для категории с использованием метода `addCSSClassCategory`.

**Параметры:**

- `value`: Текст категории товара (`string`).

#### `get description(): string`

Возвращает текст описания товара. Если элемент описания существует, возвращает его текстовое содержимое.

**Возвращает:**

- Описание товара (`string`).

#### `set description(value: string): void`

Устанавливает текст описания товара в соответствующий DOM элемент, если элемент описания существует.

**Параметры:**

- `value`: Описание товара (`string`).

#### `addClassToCategory(value: string): void`

Реализует метод добавления класса к элементу категории товара. Удаляет старые классы категории и добавляет новый класс, основываясь на значении `value` и константах из `categories`.

**Параметры:**

- `value`: Класс для добавления (`string`).

### Зависимости

- **`IProductCatalog`**: Интерфейс для представления каталога товаров, включая его свойства и методы.
- **`ensureElement`**: Утилитная функция для безопасного получения одного DOM элемента.
- **`Product`**: Абстрактный класс для представления карточки товара, предоставляющий базовые методы и свойства.
- **`categories`**: Константы, определяющие CSS классы для категорий товаров.
- **`IEvents`**: Интерфейс для работы с событиями.

# Файл `productInBasket.ts`

## Описание

Файл `productInBasket.ts` содержит реализацию класса `ProductInBasket`, который представляет товар в корзине покупок. Этот класс расширяет абстрактный класс `Product` и реализует интерфейс `IProductBasket`. Класс управляет отображением порядкового номера товара в корзине и кнопкой удаления товара.

## Класс `ProductInBasket<TProductBasket>`

### Свойства

- **`_index`**: DOM элемент для отображения порядкового номера товара (`HTMLSpanElement`). Элемент, в котором отображается порядковый номер товара в корзине.

- **`buttonDelete`**: DOM элемент для кнопки удаления товара из корзины (`HTMLButtonElement`). Кнопка, с помощью которой можно удалить товар из корзины.

### Конструктор

#### `constructor(container: HTMLElement, events: IEvents)`

Создает экземпляр класса `ProductInBasket`, инициализируя элементы страницы для отображения товара в корзине. Ищет и сохраняет DOM элементы для порядкового номера и кнопки удаления товара. Добавляет обработчик клика на кнопку удаления, который вызывает событие `viewCard:deleteFromBasket`, передающее идентификатор товара.

**Параметры:**

- `container`: DOM элемент, содержащий карточку товара в корзине (`HTMLElement`).
- `events`: Экземпляр класса `IEvents`, используемый для управления событиями.

### Методы и свойства

#### `set index(value: number): void`

Устанавливает порядковый номер товара в корзине. Значение `value` увеличивается на 1 перед установкой текста в элемент `_index`.

**Параметры:**

- `value`: Порядковый номер товара (`number`).

#### `get index(): number`

Возвращает порядковый номер товара в корзине. Преобразует текстовое содержание элемента `_index` в число и уменьшает на 1, чтобы получить исходный номер.

**Возвращает:**

- Порядковый номер товара в корзине (`number`).

#### `get image(): string`

Возвращает пустую строку, так как в корзине изображение не отображается.

**Возвращает:**

- Пустую строку (`string`).

#### `set image(src: string): void`

Пустая реализация, так как в корзине изображение не используется.

**Параметры:**

- `src`: URL изображения товара (`string`).

#### `get description(): string`

Возвращает пустую строку, так как описание товара в корзине не используется.

**Возвращает:**

- Пустую строку (`string`).

#### `set description(value: string): void`

Пустая реализация, так как описание товара в корзине не используется.

**Параметры:**

- `value`: Описание товара (`string`).

#### `addClassToCategory(value: string): void`

Пустая реализация, так как класс категории не используется в корзине.

**Параметры:**

- `value`: Класс для добавления (`string`).

### Зависимости

- **`IProductBasket`**: Интерфейс для представления товара в корзине, включая его свойства и методы.
- **`ensureElement`**: Утилитная функция для безопасного получения одного DOM элемента.
- **`Product`**: Абстрактный класс для представления карточки товара, предоставляющий базовые методы и свойства.
- **`IEvents`**: Интерфейс для работы с событиями.

# Файл `productPreview.ts`

## Описание

Файл `productPreview.ts` содержит реализацию класса `ProductPreview`, который представляет предварительный просмотр товара на веб-странице. Этот класс отвечает за отображение информации о товаре и управление кнопкой для добавления товара в корзину или удаления из неё. Он реализует интерфейсы `IProductPreview` и `IProductItem`, а также расширяет абстрактный класс `View`.

# Класс `ProductPreview`

## Описание

Класс `ProductPreview` представляет предварительный просмотр товара на веб-странице. Он управляет отображением информации о товаре, такой как заголовок, категория, цена, изображение и описание, а также состоянием кнопки для добавления товара в корзину или удаления из нее.

## Свойства

- **`buttonBuy`**: DOM элемент кнопки, предназначенной для добавления товара в корзину или удаления его из корзины. Тип: `HTMLButtonElement`.

- **`title`**: Заголовок товара. Тип: `string`.

- **`category`**: Категория товара. Тип: `string`.

- **`container`**: Основной контейнер для отображения товара. Тип: `HTMLElement`.

- **`price`**: Цена товара. Тип: `number`.

- **`image`**: URL изображения товара. Тип: `string`.

- **`description`**: Описание товара. Тип: `string`.

- **`id`**: Идентификатор товара. Тип: `string`.

## Конструктор

### `constructor(container: HTMLElement, events: IEvents)`

Создает экземпляр класса `ProductPreview`, инициализируя элементы страницы для отображения предварительного просмотра товара. Находит и сохраняет DOM элемент кнопки `buttonBuy`, добавляет обработчик события клика на кнопку для добавления товара в корзину или удаления из нее. При нажатии на кнопку генерируются события `viewCard:addToBasket` или `viewCard:deleteFromBasket`, в зависимости от текста кнопки.

**Параметры:**

- **`container`**: Основной контейнер для отображения товара (`HTMLElement`).
- **`events`**: Экземпляр класса `IEvents`, используемый для управления событиями.

## Методы и свойства

### `set invalidPrice(value: boolean)`

Устанавливает состояние кнопки `buttonBuy` в зависимости от валидности цены товара. Если цена недействительна (например, из-за отсутствия данных или невалидного значения), кнопка становится недоступной.

**Параметры:**

- **`value`**: Логическое значение (`boolean`), указывающее, является ли цена недействительной.

### `get invalidPrice(): boolean`

Возвращает состояние кнопки `buttonBuy`, указывающее, является ли она недоступной.

**Возвращает:**

- Логическое значение (`boolean`), указывающее, является ли кнопка недоступной.

### `set buttonValidation(value: boolean)`

Устанавливает текст кнопки `buttonBuy` в зависимости от состояния кнопки и валидности цены. Возможные состояния: `'Не продается'`, `'Убрать из корзины'`, `'Купить'`.

**Параметры:**

- **`value`**: Логическое значение (`boolean`), указывающее состояние кнопки.

### `render(data?: Partial<IProductItem & { invalidPrice: boolean; buttonValidation: boolean }>): HTMLElement`

Рендерит данные товара в контейнер. Обновляет заголовок, категорию, изображение и цену товара. Если цена недействительна (например, равна `null`, `undefined` или `0`), отображается `'Бесценно'`. Вызывает родительский метод `render` для обновления базовых данных и возвращает обновленный контейнер.

**Параметры:**

- **`data`** (необязательный): Частичный объект, содержащий данные о товаре и дополнительную информацию о валидности цены и состоянии кнопки.

**Возвращает:**

- Обновленный контейнер (`HTMLElement`).

## Зависимости

- **`IProductPreview`**: Интерфейс для представления предварительного просмотра товара, включающий свойства и методы.

- **`IProductItem`**: Интерфейс для товара, включающий его свойства.

- **`ensureElement`**: Утилитная функция для безопасного получения одного DOM элемента и его типизации.

- **`View`**: Абстрактный класс, предоставляющий базовые методы и свойства для работы с представлением, от которого наследуется `ProductPreview`.



# Файл `success.ts`

## Описание

Файл `success.ts` содержит реализацию класса `VSuccess`, который отвечает за отображение успешного завершения заказа. Этот класс предоставляет механизм для отображения сообщения об успешной операции и управления кнопкой для закрытия сообщения. Он реализует интерфейс `ISuccess` и расширяет абстрактный класс `View`.

## Класс `VSuccess`

### Свойства

- **`_message`**: DOM элемент для отображения сообщения об успешной операции (`HTMLParagraphElement`).

- **`buttonSuccess`**: DOM элемент кнопки для закрытия сообщения об успешной операции (`HTMLButtonElement`).

### Конструктор

- **`constructor(container: HTMLElement, events: IEvents)`**: Создаёт экземпляр класса `VSuccess`. Ищет и сохраняет DOM элементы для сообщения и кнопки. Добавляет обработчик события клика на кнопку `buttonSuccess`, который вызывает событие `success:submit` через объект `events`.

### Методы и свойства

- **`set message(value: number)`**: Устанавливает текст сообщения, отображая количество списанных "синапсов". Формат сообщения: `Списано ${value} синапсов`.

## Зависимости

- **`ISuccess`**: Интерфейс для описания успешного завершения заказа, включающий свойства и методы.

- **`ensureElement`**: Утилитная функция для безопасного получения одного DOM элемента.

- **`View`**: Абстрактный класс, предоставляющий базовые методы и свойства для работы с представлением.

# Файл `view.ts`

## Описание

Файл `view.ts` содержит абстрактный класс `View`, который служит базовым классом для представлений в приложении. Этот класс предоставляет набор методов для работы с DOM элементами, такими как установка текста, управление видимостью, и обработка событий.

## Класс `View<T>`

### Свойства

- **`container`**: DOM элемент, содержащий текущее представление (`HTMLElement`).

- **`events`**: Объект для управления событиями (`IEvents`).

### Конструктор

- **`constructor(container: HTMLElement, events: IEvents)`**: Инициализирует экземпляр класса `View` и сохраняет ссылку на контейнер и объект для событий.

### Методы и свойства

- **`toggleClass(element: HTMLElement, className: string, method?: boolean)`**: Переключает класс у указанного элемента. Если `method` равно `true`, класс добавляется; если `false` — удаляется.

- **`protected setText(element: HTMLElement, value: unknown)`**: Устанавливает текстовое содержимое элемента. Преобразует значение в строку.

- **`setDisabled(element: HTMLElement, state: boolean)`**: Устанавливает или снимает статус блокировки у элемента. Добавляет атрибут `disabled` при `state` равном `true`, иначе удаляет его.

- **`protected setHidden(element: HTMLElement)`**: Скрывает элемент, устанавливая его `display` в `none`.

- **`protected setVisible(element: HTMLElement)`**: Показывает элемент, удаляя `display` стиль.

- **`protected setImage(element: HTMLImageElement, src: string, alt?: string)`**: Устанавливает источник изображения и альтернативный текст для изображения. Применимо только к элементам `HTMLImageElement`.

- **`render(data?: Partial<T>): HTMLElement`**: Обновляет данные в представлении, устанавливая свойства из объекта `data`. Возвращает контейнер элемента.

## Зависимости

- **`IEvents`**: Интерфейс для управления событиями.

# Файл `vmodal.ts`

## Описание

Файл `vmodal.ts` содержит класс `CardModal`, который представляет модальное окно в приложении. Этот класс управляет открытием и закрытием модального окна, а также настройкой его содержания.

## Класс `CardModal<T>`

### Свойства

- **`_content`**: DOM элемент, представляющий содержание модального окна (`HTMLElement`).

- **`_buttonClose`**: DOM элемент кнопки закрытия модального окна (`HTMLButtonElement`).

### Конструктор

- **`constructor(container: HTMLElement, events: IEvents)`**: Инициализирует экземпляр класса `CardModal`. Устанавливает ссылки на элементы содержания и кнопку закрытия, а также добавляет обработчики событий для закрытия модального окна.

### Методы

- **`open()`**: Открывает модальное окно, добавляя класс `modal_active` к контейнеру и эмитирует событие `modal:open`.

- **`close()`**: Закрывает модальное окно, удаляя класс `modal_active` из контейнера и эмитирует событие `modal:close`.

- **`set content(value: HTMLElement)`**: Устанавливает содержание модального окна, заменяя текущее содержание новым элементом.

## Зависимости

- **`ensureElement`**: Функция для нахождения и проверки наличия DOM элементов.
- **`IEvents`**: Интерфейс для управления событиями.
- **`View`**: Базовый класс для представлений, предоставляющий методы для управления DOM элементами.

# Слой Presenter

# Файл `index.ts`

## Описание

Файл `index.ts` реализует основное приложение, координируя работу всех ключевых компонентов интерфейса. Он отвечает за инициализацию данных, настройку представлений, обработку событий, взаимодействие с API и обновление интерфейса в зависимости от состояния приложения.

## Основные компоненты

### Инициализация данных

- **`events`**: Экземпляр `EventEmitter`, который управляет событиями в приложении. Используется для обмена сообщениями между компонентами.

- **`productData`**: Экземпляр `ProductItem`, который управляет данными о товарах, полученными с сервера.

- **`basketData`**: Экземпляр `ShoppingCart`, который управляет данными корзины, включая добавление и удаление товаров.

- **`orderData`**: Экземпляр `Order`, который управляет данными заказа, такими как платежные реквизиты и адрес доставки.

### Инициализация элементов представления

- **`elements`**: Объект, содержащий ссылки на ключевые элементы интерфейса и шаблоны для рендеринга:

  - **`containerPage`**: Контейнер для основной страницы приложения.

  - **`containerModal`**: Контейнер для модальных окон.

  - **`templates`**: Шаблоны для различных представлений:
    - **`cardPreview`**: Шаблон для предварительного просмотра карточки товара.
    - **`cardCatalog`**: Шаблон для карточки товара в каталоге.
    - **`cardBasket`**: Шаблон для карточки товара в корзине.
    - **`basket`**: Шаблон для корзины.
    - **`order`**: Шаблон для формы заказа.
    - **`contacts`**: Шаблон для формы контактных данных.
    - **`success`**: Шаблон для сообщения об успешном завершении заказа.

- **`views`**: Объект, содержащий экземпляры различных представлений:
  - **`page`**: Представление для основной страницы приложения.
  - **`modal`**: Представление для общего модального окна.
  - **`cardModal`**: Представление для модального окна с подробной информацией о товаре.
  - **`cardPreview`**: Представление для предварительного просмотра карточки товара.
  - **`basket`**: Представление для корзины.
  - **`formOrder`**: Представление для формы заказа.
  - **`formContacts`**: Представление для формы контактных данных.
  - **`success`**: Представление для сообщения об успешном завершении заказа.

### Получение экземпляра API

- **`api`**: Экземпляр `AppApi`, который используется для взаимодействия с сервером. Получает и отправляет данные, такие как информация о товарах и заказы.

### Основные обработчики событий

- **`loadProducts()`**: Асинхронная функция, которая загружает данные о товарах с сервера и обновляет интерфейс. При успешной загрузке данных генерирует событие `cards:changed`.

- **`events.on('cards:changed')`**: Обработчик события, который обновляет список товаров на странице при изменении данных о товарах. Создает и рендерит карточки товаров.

- **`events.on('productModal:open')`**: Обработчик события, открывающий модальное окно с подробной информацией о выбранном товаре.

- **`events.on('viewCard:addToBasket')`**: Обработчик события, который добавляет товар в корзину.

- **`events.on('viewCard:deleteFromBasket')`**: Обработчик события, который удаляет товар из корзины.

- **`events.on('basketData:changed')`**: Обработчик события, который обновляет данные корзины и отображение изменений в корзине.

- **`events.on('viewBasket:open')`**: Обработчик события, открывающий модальное окно с содержимым корзины.

- **`events.on('order:open')`**: Обработчик события, открывающий модальное окно с формой заказа.

- **`events.on('order:submit')`**: Обработчик события, который отправляет заказ и открывает форму контактных данных.

- **`events.on('contacts:submit')`**: Обработчик события, который отправляет контактные данные и завершает оформление заказа.

- **`events.on('success:submit')`**: Обработчик события, который закрывает модальное окно после успешного завершения заказа.

### Инициализация приложения

- **`loadProducts()`**: Вызов функции для загрузки данных о товарах при запуске приложения.

## Зависимости

- **`EventEmitter`**: Компонент для управления событиями.

- **`ProductItem`, `ShoppingCart`, `Order`**: Компоненты для управления данными о товарах, корзине и заказах.

- **`Page`, `ProductPreview`, `Basket`, `FormOrder`, `FormContacts`, `VSuccess`, `CardModal`, `Modal`**: Компоненты представлений для отображения различных частей интерфейса.

- **`AppApi`**: Компонент для взаимодействия с сервером через API.

- **`cloneTemplate`, `ensureElement`**: Утилиты для работы с DOM и шаблонами.
